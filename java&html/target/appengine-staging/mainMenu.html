<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
  <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
  <title>Main Menu</title>
  <link rel="stylesheet" type="text/css" href="styles.css">
</head>

<body>

<h1 id="header-username"></h1>
<h2 id="header-role" class="role su-role gs-role ga-role gbo-role user-role"></h2>

<table>
  <tr>
    <td><a href='remove/removeMenu.html'>Remove User</a></td>
  </tr>
  <tr>
    <td><a href='list/listUsers.html'>List Users</a></td>
  </tr>
  <tr>
    <td><a id="modLink" href='update/updateUser.html'>Modify User</a></td>
  </tr>
  <tr>
    <td><a href='changePwd/changePwd.html'>Change Password</a></td>
  </tr>
  <tr>
    <td><a href='token/showToken.html'>Check Authorization Token</a></td>
  </tr>
  <tr>
    <td><a id="extraLink" href='extra/getUser.html'>Get a User</a></td>
  </tr>
  <tr>
    <td>
      <form id="form">
        <button>Logout</button>
      </form>
    </td>
  </tr>
</table>

<a id="google-cloud" href="https://console.cloud.google.com/welcome?authuser=2&hl=pt-br&project=peak-castle-382619">Google Cloud Link</a>

<script>

  if (!(JSON.parse(sessionStorage.getItem("token")).role === "SU") && !(JSON.parse(sessionStorage.getItem("token")).role === "USER")) {
    document.getElementById("extraLink").style.display = "none";
  }

  if(!(JSON.parse(sessionStorage.getItem("token")).role === "SU"))
    document.getElementById("google-cloud").style.display = "none";

  const headerUsername = document.getElementById("header-username");

  const username = JSON.parse(sessionStorage.getItem("token")).username;

  if (username) {
    headerUsername.textContent = `Welcome, ${username}!`;
  }

  const headerRole = document.getElementById("header-role");

  const role = JSON.parse(sessionStorage.getItem("token")).role;

  if  (role){
    headerRole.textContent = `Your role: ${role}`;

    if (role === 'USER') {
      headerRole.classList.add('user');
    } else if(role === 'GBO'){
      headerRole.classList.add('gbo');
    } else if(role === 'GA'){
      headerRole.classList.add('ga');
    } else if (role === 'GS') {
      headerRole.classList.add('gs');
    } else if (role === 'SU') {
      headerRole.classList.add('su');
    }


  }


  const modifyUserLink = document.getElementById("modLink");

  if (JSON.parse(sessionStorage.getItem("token")).role === 'USER') {
    modifyUserLink.href = '/update/updateUser.html';
  } else {
    modifyUserLink.href = '/update/updateAdmin.html';
  }




  const form = document.getElementById("form");

  form.addEventListener("submit", (event) => {
    event.preventDefault();
    sessionStorage.removeItem("token");
    window.location.href = "/index.html"
  })

</script>

</body>
<footer>
  Copyright: FCT NOVA 2023
</footer>
</html>